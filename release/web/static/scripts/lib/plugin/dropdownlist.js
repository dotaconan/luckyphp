define(["jquery"],function(e){var t=function(){var t={themeIdPrefix:"dropdownThemeFor",themeId:"dropdownThemeFor#{id}",listId:"dropdownOptionsFor#{id}",classDropdownlsit:"mod-dropdownlist",classFormitem:"dropdown-select",classInput:"dropdown-input",classIcon:"dropdown-icon",classOptions:"dropdown-options",classFocusLi:"dropdown-options-focus",classList:"dropdown-list",classCustomScrollbar:"custom-scroll-bar",classCustomBox:"dropdown-custombox",attrOptionValue:"data-value",attrStylesCols:"data-cols",attrStylesWidth:"data-width"},n=[],r=function(){for(;;){var e=((new Date).getTime()+"Select"+Math.floor(Math.random()*1e5)).toString();if(!n[e])return n[e]=!0,e}},i=function(e,t){source=e;var n=Array.prototype.slice.call(arguments,1),r=Object.prototype.toString;return n.length?(n=n.length==1?t!==null&&/\[object Array\]|\[object Object\]/.test(r.call(t))?t:n:n,source.replace(/#\{(.+?)\}/g,function(e,t){var i=n[t];return"[object Function]"==r.call(i)&&(i=i(t)),"undefined"==typeof i?"":i})):source},s=function(){};s.prototype={constructor:s,_addListItem:function(n){var r=this,i=e("<a></a>");i.attr(t.attrOptionValue,n.value),i.html(n.text),i.attr("href","javascript:;");var s=e("<li></li>");return i.click(function(n){var i=e(this).attr(t.attrOptionValue);r.select.val(i),r.select.trigger("change"),r.hide().listEle.trigger("hide-list")}),s.append(i),r.listUL.append(s),r},setSelectItemByIndex:function(e){var t=this;console.log(t)},findIndexByValue:function(e,t){var n=0;for(var r=0;r<e.length;r++){var i=e[r][1];if(i===t)return r}return n},findSelectedIndex:function(e){var t=0;for(var n=0;n<e.length;n++){var r=e[n][2];if(r===!0)return n}return t},setSelectItemByValue:function(e){var t=this,n=t.findIndexByValue(t.configs.options,e),r=t.findSelectedIndex(t.configs.options);t.select.val(e),t.select.trigger("change"),t.hide().listEle.trigger("hide-list")},_list:function(){var n=this;this.listId=i(t.listId,{id:this.select.attr("id")||r()}),this.listEle=e("<div></div>").attr("id",this.listId).addClass(t.classList).addClass(t.classCustomScrollbar).hide(),this.listUL=e("<ul></ul>").appendTo(this.listEle),this.listBox=e("<div></div>").appendTo(this.listEle).addClass(t.classCustomBox),this.configs.box&&this.listBox.append(this.configs.box);var s=function(t){e.contains(n.listEle[0],t.target)||n.hide()};this.listEle.bind("show-list",function(){e(document).bind("click",s)}),this.listEle.bind("hide-list",function(){e(document).unbind("click",s)});var o=this.select[0].options;e.each(o,function(e,t){n._addListItem(t)}),this.listUL.addClass(t.classOptions);var u=function(){e(window).unbind("resize",u),setTimeout(function(){var t=n.element.position();n.listEle.css({left:t.left-1,top:t.top+n.element[0].offsetHeight}),e(window).resize(u)},10)};e(window).resize(u),n.listEle.appendTo(n.dropdownEle)},_createFromSelect:function(){this.select=e(this.configs.select);var n=i(t.themeId,{id:this.select.attr("id")}),r=e("<a></a>").attr({id:n,href:"javascript:;","class":t.classFormitem}),s=e("<span></span>").attr({"class":t.classInput}),o=e("<span></span>").attr({"class":t.classIcon}),u=this.select.attr("class");this.select[0].selectedIndex>=0&&s.html("<nobr>"+this.select[0].options[this.select[0].selectedIndex].text+"</nobr>"),o.html("&#160"),r.append(s).append(o),u&&e.each(u.split(/\s+/),function(e,t){r.addClass(t)}),this.select.hide(),this.dropdownEle=e("<div></div>").append(r).insertAfter(this.select).addClass(t.classDropdownlsit).addClass(this.configs.className||"");var a=this.select.attr(t.attrStylesWidth)||"";if(a){var f=parseInt(s.css("padding-left"),10)||0,l=parseInt(s.css("padding-right"),10)||0;s.css("width",parseInt(a,10)-f-l-o[0].offsetWidth-3)}s.parent().click(function(t){e(this).attr("data-showwing")==1?c.hide():c.show(),t.preventDefault(),t.stopPropagation()});var c=this;return this.select.change(function(e){c.select[0].selectedIndex>=0&&s.html("<nobr>"+c.select[0].options[c.select[0].selectedIndex].text+"</nobr>")}),this.input=s,this.icon=o,this.element=s.parent(),this._list(),r},_init:function(n){this.configs=e.extend({container:"body"},n||{});var s,o={};o.id=this.configs.attrs.id||r(),o["data-cols"]=this.configs.attrs.column||8,this.configs.attrs.width&&(o["data-width"]=this.configs.attrs.width);if(this.configs.options){this.configs.attrs.id&&(o.id=this.configs.attrs.id),o["data-cols"]=this.configs.attrs.column||8,this.configs.attrs.width&&(o["data-width"]=this.configs.attrs.width),s=e("<select></select>").attr(o).hide().appendTo(e(this.configs.container));var u,a;e.each(this.configs.options,function(e,t){a=new Option(t[0]||t,t[1]||t[0]||t),t[2]&&(a.selected=!0,a.setAttribute("selected","selected"),u=e),s[0].options.add(a)}),this.configs.select=s}else{s=this.configs.select.attr(o).hide();if(!s.is("select"))return}return e("#"+i(t.themeId,{id:s[0].id})).remove(),s[0].options.length&&this._createFromSelect(s).show(),this},val:function(e){return(e||"").length?(this.select.val(e).trigger("change"),this):this.select.val()},change:function(){return arguments.length?this.select.change.apply(this.select,arguments):(this.select.trigger("change"),this)},show:function(){var n=this;n.element.attr("data-showwing",1);var r=parseInt(n.configs.attrs.height,10)||30;e("li a",n.listUL).css({height:r+"px","line-height":r+"px"});var s=n.select.attr(t.attrStylesCols)||"10",o=e("li",n.listUL),u=r*Math.min(parseInt(s,10),o.length),a=e("#"+i(t.themeId,{id:n.select.attr("id")})),f=a.position(),l={position:"absolute",left:f.left,top:f.top+a[0].offsetHeight,width:a[0].offsetWidth-(parseInt(a.css("border-left-width"),10)||0)-(parseInt(a.css("border-right-width"),10)||0),"z-index":(parseInt(n.select.parent().css("z-index"),10)||0)+10};n.listUL.css({height:u}),n.listEle.css(l).show().trigger("show-list");var c;return e.each(o,function(r,i){if(n.select.val()==e("a",i).attr(t.attrOptionValue))return c=i,!1}),c&&setTimeout(function(){e(c).siblings("li").removeClass(t.classFocusLi).end().addClass(t.classFocusLi),c.parentNode.scrollTop=c.offsetTop},10),n},hide:function(){return this.element.attr("data-showwing",0),this.listEle.hide().trigger("hide-list"),this},add:function(e){var t=new Option(e.text,e.value);return this.select[0].options.add(t),this._addListItem(t),this}};var o=function(e){return(new s)._init(e)};return{version:"1.3",create:o}}();return t});