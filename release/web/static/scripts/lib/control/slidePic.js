define([],function(){function e(e){this.opt=e||{},this.box=this.opt.box||"#carousel",this.handle=this.opt.handle||".carousel-handle",this.handleEl=this.opt.handleEl||"span",this.list=this.opt.list||"ul",this.item=this.opt.item||"li",this.turnBtn=this.opt.turnBtn||".carousel-btn",this.delay=this.opt.delay||5e3,this.activeDelay=this.opt.activeDelay||!0,this.activeDelayTime=this.opt.activeDelayTime||300,this.speed=this.opt.speed||500,this.auto=this.opt.auto||!0,this.init(),this.callback=this.opt.callback||null}return e.prototype={init:function(){var e=this;e.index=0,e.box=$(e.box),e.list=e.box.find(e.list),e.items=e.list.find(e.item),e.turnBtn=e.box.find(e.turnBtn),e.handle=e.box.find(e.handle),e.initHandler(),e.btns=e.box.find(e.handle).find(e.handleEl),e.len=e.items.length,e.prev=e.items.eq(0),e.items.eq(0).css({zIndex:2}),e.timeHandle=0,e.tiptime=0,e.start()},initHandler:function(){var e=this,t=e.items.length;e.handle.empty();for(var n=0;n<t;n++)e.handle.append("<a href='javascript:void(0)'></a>");e.handle.find(e.handleEl).eq(0).addClass("on")},start:function(){function t(){e.timeHandle&&clearInterval(e.timeHandle),e.timeHandle=setInterval(function(){r()},e.delay)}function n(t){if(e.prev.index()==t)return;e.items.css({zIndex:"1"}),e.prev.css({zIndex:"2"});var n=e.items.eq(t).attr("data-backgroundImage");if(n){var r='<img src="'+n+'" width="100%" height="100%" />';e.items.eq(t).find("a").append(r)}e.items.eq(t).css({opacity:0,zIndex:"3"}).stop().animate({opacity:1},e.speed),e.btns.removeClass("on").eq(t).addClass("on"),e.index=t,e.prev=e.items.eq(t),e.callback&&typeof e.callback=="function"&&e.callback({box:e.box,index:e.index})}function r(){e.index=e.index>=e.len-1?e.index=0:e.index+=1,e.btns.eq(e.index).trigger("mouseover").trigger("mouseleave")}function i(){return e.index}var e=this;e.callback&&typeof e.callback=="function"&&e.callback({box:e.box,index:e.index}),e.btns.hover(function(t){var r=$(this),i=r.index(),t=t||window.event;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,clearTimeout(e.tiptime),clearInterval(e.timeHandle),t.isTrigger==1?n(i):e.tiptime=setTimeout(function(){n(i)},e.activeDelayTime)},function(){clearTimeout(e.tiptime),t()}),t(),e.items.hover(function(){clearInterval(e.timeHandle)},function(){t()}),e.box.hover(function(){$.browser.msie&&$.browser.version>8?e.turnBtn.stop(!0,!0).fadeIn("fast"):e.turnBtn.show()},function(){$.browser.msie&&$.browser.version>8?e.turnBtn.stop(!0,!0).fadeOut("fast"):e.turnBtn.hide()}),e.turnBtn.live({mouseover:function(){e.timeHandle&&clearInterval(e.timeHandle),e.tiptime=0,e.timeHandle=0;var t=$(this);t.hasClass("carousel-prev")?t.addClass("carousel-prev-hover"):t.addClass("carousel-next-hover")},click:function(){var t=$(this).hasClass("carousel-prev"),r=i(),s=e.items.length-1;if(t){var o=r==0?s:r-1;n(o)}else{var u=r==s?0:r+1;n(u)}},mouseleave:function(){var e=$(this);e.hasClass("carousel-prev")?e.removeClass("carousel-prev-hover"):e.removeClass("carousel-next-hover"),t()}})}},e});